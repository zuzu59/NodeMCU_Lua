<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
  <meta charset='utf-8' name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>SonOff home page</title>
</head>
<body>
    <h1>SonOff home page 200105.2228</h1>
    <h2>Menu:</h2>
    <h3>
    <a href="api_sonoff.html?LED=on">SonOff API LED On</a><br>
    <a href="api_sonoff.html?LED=off">SonOff API LED OFF</a><br>
    <a href="api_sonoff.html?RELAY=on">SonOff API RELAY On</a><br>
    <a href="api_sonoff.html?RELAY=off">SonOff API RELAY OFF</a><br>
    <br>
    <a href="wifi_clear.html?field1=11&field2=12&field3=13">Wifi clear, effacement configuration WIFI</a><br>
    <a href="disp_temp.html">Affichage des températures, affiche les températures mesurées</a><br>
    </h3>



<%
            if (vars ~= nil) then
                zout("<br>vars: "..vars.."<br>")
                for k, v in string.gmatch(vars, "(%w+)=(%w+%p+%w+)&*") do
                    _GET[k] = v
                    zout(k..": "..v.."<br>")
                end
            end
            if (_GET.SetupWIFI == "true") then

                zout("setup wifi...")
                print("toto")
                --wifi.setmode(wifi.NULLMODE)
                --enduser_setup.start(function()
                --    node.restart()
                --end)



            
            end
            if (_GET.RESTART == "true") then

                zout("oups restart...")
            
            end
%>










    <br>Etat de la LED:<nsp>
<%
    zLED=7      -- SonOff
    if gpio.read(zLED) == 1 then zout("OFF") else zout("ON") end
%>

    <br>Etat du RELAY:<nsp>
<%
    zRELAY=6
    if gpio.read(zRELAY) == 0 then zout("OFF") else zout("ON") end
%>

    <br><br>
<%
    if wifi.sta.getip() ~= nil then
        a,b,c = wifi.sta.getip()
        zout("IP: "..a.."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MASK: "..b.."&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GATEWAY: "..c.."<br>")
    end
    collectgarbage()   zout("RAM: "..node.heap())
%>
</body>
</html>
